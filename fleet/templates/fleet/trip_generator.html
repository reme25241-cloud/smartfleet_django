{% extends 'fleet/base.html' %}
{% load fleet_extras %}
{% block title %}Trip Generator{% endblock %}
{% block content %}
<h1 class="text-2xl font-semibold mb-6">Trip Generator</h1>
<div class="grid md:grid-cols-3 gap-6 mb-6 text-center">
  <div class="bg-[#1C2541] p-4 rounded-lg"><p class="text-3xl font-bold">{{ trip_count }}</p><p class="text-gray-400">Total Trips Generated</p></div>
  <div class="bg-[#1C2541] p-4 rounded-lg"><p class="text-3xl font-bold">{{ total_flags }}</p><p class="text-gray-400">Flags</p></div>
  <div class="bg-[#1C2541] p-4 rounded-lg"><p class="text-3xl font-bold">â‚¹{{ total_freight|floatformat:2 }}</p><p class="text-gray-400">Total Freight</p></div>
</div>

<form method="POST" class="bg-[#3A506B] p-6 rounded-lg grid md:grid-cols-2 gap-4 mb-8">
  {% csrf_token %}
  {% for fld in generator_fields %}
    <div>
      <label class="block text-sm text-gray-200">{{ fld.label }}</label>
      <input name="{{ fld.name }}" value="{{ parsed_data|get_item:fld.name }}" class="w-full px-3 py-2 rounded bg-gray-200 text-black" {% if fld.required %}required{% endif %} type="{{ fld.type }}">
    </div>
  {% endfor %}
  <button type="submit" class="mt-6 bg-[#1C2541] hover:bg-[#3A506B] px-4 py-2 rounded text-white md:col-span-2">Submit</button>
</form>

<h2 class="text-xl font-semibold mb-4">Trip Generated Details</h2>
<div class="overflow-x-auto">
  <table class="min-w-full bg-white text-black rounded shadow overflow-hidden">
    <thead class="bg-[#3A506B] text-white">
      <tr>{% for col in generator_headers %}<th class="px-2 py-2">{{ col }}</th>{% endfor %}</tr>
    </thead>
    <tbody>
      {% for trip in all_trips %}
      <tr class="border-t">{% for item in trip %}<td class="px-2 py-1">{{ item }}</td>{% endfor %}</tr>
      {% empty %}
      <tr><td class="px-2 py-2 text-center text-gray-500" colspan="{{ generator_headers|length }}">No trips yet.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
